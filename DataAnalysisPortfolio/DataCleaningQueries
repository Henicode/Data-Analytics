-- data cleaning project --




-- Converting the date value for the sale date --


SELECT SaleDate, CONVERT(date, SaleDate)
FROM data_clean;

UPDATE data_clean
SET SaleDate = CONVERT(date, SaleDate)

-- property address null or empty values to be assigned as owneraddress
 
 
 -- This query joins the same table together using their parcel id and is not the same in their unique id --
 -- this basically says where their parcel id colum is the same but their row is different 
 
SELECT * 
FROM data_clean a
JOIN data_clean b
 on a.ParcelID = b.ParcelID  
 AND a.[UniqueID] <> b.[UniqueID]

-- query will identify the rows where they are empty or null values where their columns are the same but have different rows ---

SELECT a.ParcelID, a.PropertyAddress, b.ParcelID, b.OwnerAddress, ISnull(a.PropertyAddress, B.OwnerAddress)
FROM data_clean a                                                     -- ABOVE query will identity the all the null values in the first parameter (PropertyAddress) and replace it with the second parameter (OwnerAddress)
JOIN data_clean b
 on a.ParcelID = b.ParcelID  
 AND a.[uniqueID] <> b.[uniqueID] 
 WHERE a.PropertyAddress = ''
  
             -- Below query updates all the empty values of the property address with the owneraddress 
update data_clean
set PropertyAddress = OwnerAddress
WHERE PropertyAddress = ''
